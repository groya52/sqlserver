AlwaysON
    8 вторичных реплик (асинхронныe реплики).
    
    1-ая вторичная реплика используется, для автоматического перехода, после сбоя (с использованием режима синхронной фиксации).
    
    Два режима первичной репликации: : синхронный (до трех узлов) и асинхронный.
    
    Используется сжатие записей транзакций, которое сжимает все записи журнала транзакций.
    
    Группы доступности также используют концепцию конечной точки для всей связи (и видимости) 
    с одного узла на другой в конфигурации группы доступности.
    
Создание многоузловой конфигурации AlwaysON:
    1. Убедитесь, что экземпляры SQL Server являются живыми и работоспособными.
    2. Настройте WSFC.
    3. Подготовьте базу данных.
    4. Включите AlwaysOn HA.
       По умолчанию отключен.
       Вызовите  Configuration Manager и выберите узел Службы SQL Server на панели Services. 
       Щелкните правой кнопкой мыши экземпляр SQL Server для этого узла и выберите Properties.
       Перейдите на вкладку AlwaysOn High Availability и установите флажок Enable AlwaysOn Availability Groups.
       Потребуется перезапуск службы.
       
       PowerShell
       Enable -SqlAlwaysOn –ServerInstance SQL16DXD_DB01 -FORCE
       Перезапускает службу SQL Server.
    5. Резервное копирование первичной базы данных.
       Будет использоваться для создания баз данных на вторичных репликах.
       
       Копировать эту полную резервную копию базы данных на каждый дополнительный экземпляр и восстанавить ее.
       При выполнении этих восстановлений обязательно укажите параметр NORECOVERY.
    6. Создайте группу доступности.
       Щелкнуть правой кнопкой мыши узел AlwaysOn High Availability и выбрать New Availability Group Wizard.
       
       В мастере создания группы доступности вы можете указать:
       - имя группы доступности;
         Параметр определения уровня работоспособности базы данных группы доступности.
         https://docs.microsoft.com/ru-ru/sql/database-engine/availability-groups/windows/sql-server-always-on-database-health-detection-failover-option?view=sql-server-2017
       - выбрать реплицируемые базы данных;
       - выбрать синхронизацию данных; 
       - выбор реплик;
       - а затем выполнить проверки.       
    7. Выберите базы данных для группы доступности.
    8. Определите первичные и вторичные реплики.       
    9. Синхронизируйте данные (первичные для реплик).
    10. Настройте слушателя (прослушиватель группы доступности).
        Чтобы завершить абстрагирование имен экземпляров от приложений, 
        вы должны создать прослушиватель группы доступности, 
        чтобы завершить эту конфигурацию.
        
        VNN кластера привязывается к имени слушателя группы доступности в этом процессе. 
        Это также имя, доступное для приложений для подключения к группе доступности. 
        Пока хотя бы один узел функционирует в группе доступности, 
        приложения никогда не знают, что какой-либо узел потерпел неудачу.
    11. Подключитесь к слушателю.
    12. Откажитесь от вторичного.
    
Мониторинг.
    Панель управления.
        Вы можете открыть панель инструментов AlwaysOn, 
        щелкнув правой кнопкой мыши группу доступности и выбрав Show Dashboard.
        
        Вы можете использовать эту панель, чтобы сделать следующее:
            - Выберите реплику для отказоустойчивости вручную.
            - Оценить потерю данных, если вы принудительно восстановите работу.
            - Оцените производительность синхронизации данных.
            - Оцените влияние производительности синхронной фиксации вторичной реплики.
            
        Ключевые состояния:
            - Состояние свертывания реплик.
            - Режим синхронизации и состояние.
            - Оценочная потеря данных.
            - Расчетное время восстановления (повторное догоняющее действие).
            - Сведения о реплике базы данных.
            - Режим синхронизации и состояние.
            - Время восстановления журнала.
    DMVs.
        sys.dm_hadr_auto_page_repair
            Возвращает строку для каждой попытки автоматического восстановления страниц во всех базах данных доступности в реплике доступности, 
            размещенной в группе доступности на экземпляре сервера.
        sys.dm_hadr_cluster_networks
            Возвращает по строке для каждого из элементов кластера WSFC,
            участвующего в конфигурации подсети группы доступности.
        sys.dm_hadr_availability_group_states
            Возвращает по одной строке для каждой группы доступности AlwaysOn, 
            у которых имеется реплика доступности на локальном экземпляре SQL Server.
        sys.dm_hadr_database_replica_cluster_states
            Возвращает строку, содержащую сведения должны давать вам подробные сведения о работоспособности баз данных доступности в группе доступности AlwaysOn, 
            в каждой группы доступности AlwaysOn в кластере сервера отказоустойчивой кластеризации Windows (WSFC).
        sys.dm_hadr_availability_replica_cluster_nodes
            Возвращает по строке для каждой из реплик доступности (независимо от состояния соединения) в группах доступности AlwaysOn в отказоустойчивой кластеризации Windows Server (WSFC).
        sys.dm_hadr_database_replica_states
            Возвращает строку для каждой базы данных, 
            участвующих в группе доступности AlwaysOn для которой в локальном экземпляре SQL Server размещается реплика доступности.
        sys.dm_hadr_availability_replica_cluster_states
        
        sys.dm_hadr_instance_node_map
        
        sys.dm_hadr_availability_replica_states
        
        sys.dm_hadr_name_id_map
        
        sys.dm_hadr_cluster
        
        sys.dm_tcp_listener_states
        
        sys.dm_hadr_cluster_members

        sys.availability_databases_cluster
        
        sys.availability_groups_cluster
        
        sys.availability_group_listener_ip_addresses
        
        sys.availability_read_only_routing_lists
        
        sys.availability_group_listeners
        
        sys.availability_replicas
        
        sys.availability_groups            