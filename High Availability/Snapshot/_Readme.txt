СНИМКИ БАЗЫ ДАННЫХ ПОДДЕРЖИВАЮТСЯ ТОЛЬКО В ENTERPRISE EDITION SQL SERVER 2016.

Моментальные снимки базы данных являются отражениями по времени во всей базе данных и не привязаны к базовым объектам базы данных, из которых они извлекают свои данные. 
Снимок предоставляет полную, доступную только для чтения копию базы данных в определенный момент времени. Это не копия, по крайней мере, не полная копия, когда она изначально создана.

Это временное представление данных базы данных никогда не изменяется, даже если данные (страницы данных) в первичной базе данных (источник моментального снимка базы данных) могут измениться.
Для моментального снимка он всегда просто указывает на страницы данных, которые присутствовали на момент создания моментального снимка.
Если страница данных обновляется в исходной базе данных, копия исходной страницы исходных данных перемещается в новую цепочку страниц, 
называемую разреженным файлом с использованием технологии копирования на запись (см. рис. Страницы данных, которые копируются в разреженный файл для моментального снимка базы данных, когда страницы обновляются в исходной базе данных.jpg).

SQL Server откатывает любые незавершенные транзакции для моментального снимка базы данных, и заносит измененные страницы в разреженный файл.
Только совершенные транзакции являются частью недавно созданного моментального снимка базы данных.

Термины связаные с моментальными снимками базы данных:
    - База данных источника (Source database).
        База данных, на которой основан снимок базы данных.
    - Базы данных моментальных снимков (Snapshot databases). 
        Может быть один или несколько снимков базы данных, определенных для какой-либо одной исходной базы данных.
        Все снимки должны находиться в одном экземпляре SQL Server.
    - Резервный снимок базы данных (Database snapshot sparse file).
        Это новое расположение страниц данных содержит исходные страницы данных исходной базы данных при появлении обновлений на страницах данных исходной базы данных.
        Один разреженный файл связан с каждым файлом данных базы данных. Если у вас есть исходная база данных, выделенная одним или несколькими отдельными файлами данных, у вас есть соответствующие разреженные файлы каждого из них.
    - Возврат к снимку базы данных (Reverting to a database snapshot).
        Если вы восстанавливаете исходную базу данных на основе определенного моментального снимка базы данных, который был выполнен в определенный момент времени, вы возвращаетесь на момент снимка базы данных.
        Фактически вы выполняете операцию RESTORE с FROM DATABASE_SNAPSHOT оператором базы данных.
    - Технология копирования на запись (Copy-on-write technology).
        Как часть транзакции обновления в исходной базе данных, копия страницы данных исходной базы данных записывается в разреженный файл, 
        так что снимок базы данных, будет попрежнему видеть страницу данных на момент снимка (см. рис. Использование технологии copy-on-write с моментальными снимками базы данных.jpg).
                
        У вас не должно быть слишком много снимков базы данных, определенных в базе данных из-за накладных расходов на копирования на запись, требуемых для каждого моментального снимка. 
        Однако это зависит от волатильности исходной базы данных и емкости сервера. 
        
        Если есть низкая волатильность, и сервер не использует много процессорных, запоминающих и дисковых емкостей, эта база данных может с большей готовностью поддерживать сразу несколько отдельных снимков базы данных. 
        Если волатильность высока, а процессор, память и, возможно, емкость диска насыщены, вы должны резко сократить количество снимков базы данных.
                
Когда использовать моментальные снимки базы данных:
    - Возврат к снимку для целей восстановления.
        Чтобы вернуться к определенному интервалу моментального снимка, вы просто используете RESTORE DATABASE команду с FROM DATABASE_SNAPSHOT инструкцией.
        Кроме того, вы должны удалить все другие снимки базы данных, прежде чем использовать один из них для восстановления базы данных.
    - Защита базы данных до внесения массовых изменений.
    - Обеспечение тестирования.
        Вы можете сделать снимки базы данных тестовой базы данных перед полным тестированием (создать базовый снимок базы данных тестирования), 
        а затем вы можете вернуть базу данных теста обратно в исходное состояние
    - Предоставление базы данных отчетов.
    - Предоставление высокодоступной и разгруженной базы данных отчетов из зеркала базы данных.
        Если вы используете зеркальное отображение базы данных для повышения вашей доступности, 
        вы также можете создать моментальный снимок базы данных для этой зеркальной базы данных и предоставить моментальный снимок пользователям отчетов. 
        
        Несмотря на то, что зеркальная база данных не может использоваться для какого-либо доступа (она находится в режиме постоянного восстановления), SQL Server позволяет создать снимок.         
        Это очень мощная конфигурация в том, что моментальный снимок базы данных с зеркалом не влияет на загрузку основного сервера, гарантируя высокую производительность по сравнению с основным сервером.
        
        Когда моментальный снимок базы данных изолирован от зеркального сервера, производительность пользователей отчетов также более предсказуема, 
        поскольку они не конкурируют с транзакционными пользователями за ресурсы на главном сервере.
        
        Единственные реальные проблемы возникают, когда главный сервер выходит из строя в зеркальную базу данных. 
        Затем у вас есть как транзакционные, так и отчетные пользователи, использующие один и тот же экземпляр сервера базы данных, что влияет на производительность.
        
        Возможным решением этой ситуации было бы автоматическое (или вручную) удаление моментального снимка базы данных на зеркальном сервере, 
        если оно станет основным и создать новый моментальный снимок на старом главном сервере, если он будет доступен.
        
Безопасность для моментальных снимков базы данных.
    По умолчанию вы получаете роли и определения безопасности, которые вы создали в исходной базе данных, 
    доступной вам в рамках моментального снимка базы данных, за исключением ролей или отдельных разрешений, 
    которые у вас есть в исходной базе данных, используемой для обновления данных или объектов.
    
Управление разреженными файлами.
    - Регулярно контролируйте размер разреженных файлов.
    - Обратите особое внимание на волатильность исходной базы данных.
      Эта скорость изменения напрямую преобразуется в размер разреженного файла и насколько быстро он растет.
    - Изолируйте разреженные файлы вдали от файлов данных исходной базы данных, что бы исключить конкуренцию. 
      Всегда работайте, чтобы получить дисковый ввод-вывод как можно более параллельным.