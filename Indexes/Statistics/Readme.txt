DBCC SHOW_STATISTICS (см. DBCC SHOW_STATISTICS.sql).
    Команда DBCC SHOW_STATISTICS возвращает три набора результатов:
        1. Общие метаданные о статистике.
            Name
                Наименование.
            Updated
                Дата обновления.
            Rows
                Количество строк в индексе во время обновления статистики.
            Rows Sampled
                Общее количество строк, выбранных для статистических вычислений.
            Steps
                Число шагов в гистограмме (не более 200).
            Density
                Плотность (не используется оптимизатором запросов и отображается только для целей обратной совместимости).
            Average key length
                Средняя длина ключа.
            String Index
                Значение YES указывает, что объект статистики содержит сводную строковую статистику.
            Filter Expression
                Предикат для подмножества строк таблицы, включенных в объект статистики.
            Unfiltered Rows
                Общее количество строк в таблице перед применением критерия фильтра.
            Persisted Sample Percent
                Постоянная частота выборки, используемая для статистических обновлений, которые явно не указывают процент выборки.
                
        2. Вектор плотности.
            All density
                Плотность. 1 / кол-во уникальных значений.
            Avarage Length
                Cколько строк в среднем имеет каждая комбинация значений ключа.
            Columns
                Имена столбцов.
            
        3. Гистограмма.
            RANGE_HI_KEY
                Верхнее граничное значение столбца для шага гистограммы.
            RANGE_ROWS	
                Предполагаемое количество строк, значение столбцов которых находится в пределах шага гистограммы, исключая верхнюю границу.
            EQ_ROWS
                Предполагаемое количество строк, значение столбцов которых равно верхней границе шага гистограммы.
            DISTINCT_RANGE_ROWS
                Предполагаемое количество строк с различающимся значением столбца в пределах шага гистограммы, исключая верхнюю границу.
            AVG_RANGE_ROWS
                Среднее количество строк с повторяющимися значениями столбцов в пределах шага гистограммы, исключая верхнюю границу (RANGE_ROWS / DISTINCT_RANGE_ROWS для DISTINCT_RANGE_ROWS > 0).

            Гистограмма хранит информацию о распределении данных только для самого левого столбца статистики (индекса).
    
Существует три свойства базы данных, которые определяют, будет ли SQL Server автоматически создавать и поддерживать статистику.

    AUTO_CREATE_STATISTICS (по умолчанию ON)
        Позволяет SQL Server автоматически создавать статистические данные уровня столбца, который не имеют статистики.
        Этот параметр не влияет на статистику уровня индекса, которая всегда создается.
    AUTO_UPDATE_STATISTICS (по умолчанию ON)
        Когда статистика считается устаревшей и требует обновления, оптимизатор запросов будет ждать, пока обновится статистика, потом составлять план выполнения запроса.
    AUTO_UPDATE_STATISTICS_ASYNC (по умолчанию OFF)
        Вместо того, чтобы ждать завершения обновления статистики, оптимизатор запросов будет составлять план выполнения на основе существующих статистических данных и использовать статистику обновлений для будущих запросов после завершения обновления.
       
    ALTER DATABASE database_name SET <auto_option>
      
    <auto_option> ::=   
    {  
        AUTO_CREATE_STATISTICS { OFF | ON [ ( INCREMENTAL = { ON | OFF } ) ] }
      | AUTO_UPDATE_STATISTICS { ON | OFF }   
      | AUTO_UPDATE_STATISTICS_ASYNC { ON | OFF }  
    }  
       
    В большинстве случаев все три свойства должны быть включены.
                
Способы включения\отключения автоматического обновления статистики.
        
    sp_autostats [ @tblname = ] 'table_or_indexed_view_name'
             [ , [ @flagc = ] 'stats_value' ]
             [ , [ @indname = ] 'statistics_name' ]
            
        Когда stats_value не указан, отображается текущее значение AUTO_UPDATE_STATISTICS.
        
    Выполнение инструкции CREATE STATISTICS или UPDATE STATISTICS с параметром NORECOMPUTE.
    
    Использование параметра STATISTICS_NORECOMPUTE в инструкции CREATE INDEX.
    
Пороги обновления статистики:
    1. Когда таблица пуста, статистика устаревает, когда добавляются данные в таблицу.
    2. Когда таблица имеет менее 500 строк, статистика устаревает после 500 изменений столбцов статистики.
    3. До SQL Server 2016 и SQL Server 2016 с уровнем совместимости базы данных < 130: 
        Когда таблица имеет 500 или более строк, SQL Server устаревает после каждых 500 + (20% от общего количества строк в таблице) изменений столбцов статистики.

       В SQL Server 2016 с уровнем совместимости базы данных = 130: 
        Порог обновления статистики на больших таблицах становится динамическим и зависит от размера таблицы. 
        Чем больше строк имеет таблица, тем ниже порог. 
        Это поведение также можно включить с помощью флага трассировки T2371 в SQL Server 2008R2 SP1 и выше.
   
sp_updatestats запускает инструкцию UPDATE STATISTICS для всех пользовательских и внутренних таблиц в текущей базе данных.
    
    sp_updatestats [ [ @resample = ] 'resample']

        RESAMPLE
            Обновить каждый объект статистики, используя последнее значение частоты выборки.
            
        Если 'resample' не указан, sp_updatestats обновляет статистику с помощью выборки по умолчанию.
        
        Обновляет статистику по отключенным некластеризованным индексам и не обновляет статистику по отключенным кластеризованным индексам.
        
        Статистика для таблиц, оптимизированных для памяти всегда обновляется при выполнении sp_updatestats.

CREATE STATISTICS (см. CREATE STATISTICS.sql).       
UPDATE STATISTICS (см. UPDATE STATISTICS.sql).

Начиная с SQL Server 2016, выборки данных для построения статистики выполняется в параллельном режиме, при использовании уровня совместимости 130, чтобы повысить производительность сбор статистики.

В дополнение к статистике уровня индекса вы можете создавать отдельные статистические данные на уровне столбцов. 
В некоторых случаях SQL Server автоматически создает такую ​​статистику (начинающуюся  с префикса _WA), SQL Server автоматически не удаляет эти статистические данные на уровне столбцов после их создания.
    
Статистика не может генерироваться автоматически на таблицах оптимизированных для памяти и требует полного сканирования.

    
    
